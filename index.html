<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CAPEX Projects</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- =============================================================== -->
  <!-- Cabeçalho principal com logo e acesso rápido para novo projeto -->
  <!-- =============================================================== -->
  <header class="main-header">
    <div class="logo" aria-label="Logo CAPEX"></div>
    <button id="newProjectBtn" type="button" class="btn primary">Novo Projeto</button>
  </header>

  <!-- =============================================================== -->
  <!-- Aplicação: sidebar com lista e painel de detalhes do projeto -->
  <!-- =============================================================== -->
  <div id="app" class="app-layout">
    <aside id="projectSidebar" class="sidebar">
      <div class="sidebar-header">
        <h2>Projetos</h2>
        <input id="projectSearch" type="search" placeholder="Pesquisar por nome" autocomplete="off">
      </div>
      <div id="projectList" class="project-list" role="list"></div>
    </aside>

    <section id="projectDetails" class="details" aria-live="polite">
      <div class="empty-state">
        <h2>Selecione um projeto</h2>
        <p>Escolha um item na lista ao lado para visualizar as informações ou iniciar uma edição.</p>
      </div>
    </section>
  </div>

  <!-- =============================================================== -->
  <!-- Formulário de criação/edição de projetos CAPEX -->
  <!-- =============================================================== -->
  <div id="formOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="formTitle">
    <form id="projectForm" class="project-form" novalidate>
      <div class="form-header">
        <h2 id="formTitle">Novo Projeto</h2>
        <div class="form-header-actions">
          <button type="button" id="closeFormBtn" class="btn ghost">Fechar</button>
        </div>
      </div>

      <input type="hidden" id="statusField" value="Rascunho">

      <div id="formStatus" class="feedback" aria-live="polite"></div>
      <div id="formErrors" class="feedback error" aria-live="assertive"></div>

      <!-- ============================== -->
      <!-- 1. Sobre o Projeto             -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>1. Sobre o Projeto</legend>
        <div class="field-group">
          <label for="projectName">Nome do Projeto</label>
          <input id="projectName" name="projectName" type="text" required maxlength="255" placeholder="Título do projeto">
        </div>
        <div class="field-group">
          <label for="projectBudget">Orçamento do Projeto em R$</label>
          <input id="projectBudget" name="projectBudget" type="number" min="0" step="0.01" required>
          <small id="budgetHint" class="hint"></small>
        </div>
        <div class="field-grid">
          <div class="field-group">
            <label for="approvalYear">Ano de Aprovação</label>
            <input id="approvalYear" name="approvalYear" type="number" min="1900" max="9999" required readonly>
          </div>
          <div class="field-group">
            <label for="investmentLevel">Nível de Investimento</label>
            <select id="investmentLevel" name="investmentLevel" required>
              <option value="">Selecione o nível de investimento</option>
              <option value="N1">N1 ≥ $150m Board of Directors</option>
              <option value="N2">N2 ≥ $10m X < $150m IAC/Executive Office</option>
              <option value="N3">N3 ≥ $2m X < $10m Pre-IAC</option>
              <option value="N4">N4 < $2m Local Segment</option>
            </select>
          </div>
          <div class="field-group">
            <label for="startDate">Data de Início</label>
            <input id="startDate" name="startDate" type="date" required>
          </div>
          <div class="field-group">
            <label for="endDate">Data de Término</label>
            <input id="endDate" name="endDate" type="date" required>
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 2. Origem e Função             -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>2. Origem e Função</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="fundingSource">Origem da Verba</label>
            <input id="fundingSource" name="fundingSource" type="text" required maxlength="160" placeholder="Digite a origem da verba">
          </div>
          <div class="field-group">
            <label for="projectFunction">Função do Projeto</label>
            <input id="projectFunction" name="projectFunction" type="text" required maxlength="160" placeholder="Digite a função do projeto">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 3. Informação Operacional      -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>3. Informação Operacional</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="company">Empresa</label>
            <select id="company" name="company" required>
              <option value="">Selecione...</option>
              <option>Empresa 01</option>
              <option>Empresa 02</option>
            </select>
          </div>
          <div class="field-group">
            <label for="center">Centro</label>
            <select id="center" name="center" required>
              <option value="">Selecione...</option>
            </select>
          </div>
          <div class="field-group">
            <label for="unit">Unidade</label>
            <select id="unit" name="unit" required>
              <option value="">Selecione...</option>
            </select>
          </div>
          <div class="field-group">
            <label for="location">Local de Implantação</label>
            <select id="location" name="location" required>
              <option value="">Selecione...</option>
            </select>
          </div>
          <div class="field-group">
            <label for="depreciationCostCenter">C. Custo Depreciação</label>
            <select id="depreciationCostCenter" name="depreciationCostCenter" required>
              <option value="">Selecione...</option>
            </select>
          </div>
          <div class="field-group">
            <label for="category">Categoria</label>
            <select id="category" name="category" required>
              <option value="">Selecione uma categoria</option>
              <option value="I1">Cat 1 - Segurança</option>
              <option value="I2">Cat 2 - Crescimento</option>
              <option value="I3">Cat 3 - Modificações</option>
              <option value="I4">Cat 4 - Manutenção</option>
              <option value="I5">Cat 5 - Renovações</option>
              <option value="I6">Cat 6 - Meio Ambiente</option>
              <option value="I7">Cat 7 - Informatização</option>
              <option value="I8">Cat 8 - Pesquisa e Desenvolvimento</option>
              <option value="I9">Cat 9 - SPA e Requisitos Legais Crescimento</option>
              <option value="J1">Cat 10 - SPA e Req. Legais Manut. e Meio Ambiente</option>
              <option value="J2">Cat 11 - Cilindros de Laminadores</option>
              <option value="J3">Cat 12 - Energia</option>
            </select>
          </div>
          <div class="field-group">
            <label for="investmentType">Tipo de Investimento</label>
            <select id="investmentType" name="investmentType" required>
              <option value="">Selecione um tipo de investimento</option>
              <option>CILINDROS E DISCOS</option>
              <option>ESTRATÉGICOS</option>
              <option>NORMATIVO</option>
              <option>RELINES(GRANDES REFORMAS)</option>
            </select>
          </div>
          <div class="field-group">
            <label for="assetType">Tipo de Ativo</label>
            <select id="assetType" name="assetType" required>
              <option value="">Selecione o tipo de ativo</option>
              <option value="01">EDIFICAÇÕES/BENFEITORIAS EM IMÓVEIS PRÓPRIOS</option>
              <option value="02">EDIFICAÇÕES/BENFEITORIAS EM IMÓVEIS TERCEIROS</option>
              <option value="03">MÁQUINAS/EQUIPAMENTOS/INSTALAÇÃO</option>
              <option value="06">VEÍCULOS</option>
              <option value="99">INFORMATICA (HARDWARE/SOFTWARE)</option>
            </select>
          </div>
          <div class="field-group">
            <label for="projectUser">Controller</label>
            <input id="projectUser" name="projectUser" type="text" required maxlength="160" placeholder="Informe o Ponto Focal">
          </div>
          <div class="field-group">
            <label for="projectLeader">Coordenador do Projeto</label>
            <input id="projectLeader" name="projectLeader" type="text" required maxlength="160" placeholder="Informe o Responsável">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 4. Detalhamento Complementar   -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>4. Detalhamento Complementar</legend>
        <div class="field-group">
          <label for="businessNeed">Necessidade do Negócio</label>
          <textarea id="businessNeed" name="businessNeed" rows="4" required></textarea>
        </div>
        <div class="field-group">
          <label for="proposedSolution">Solução da Proposta</label>
          <textarea id="proposedSolution" name="proposedSolution" rows="4"></textarea>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 5. Elemento PEP (até 1MM)      -->
      <!-- ============================== -->
      <fieldset id="simplePepSection" class="form-section hidden">
        <legend>5. Elemento PEP</legend>
        <p class="hint">Disponível apenas quando o orçamento é inferior a R$ 1.000.000,00.</p>
        <div id="simplePepList" class="dynamic-list"></div>
        <button type="button" id="addSimplePepBtn" class="btn ghost">Adicionar PEP</button>
      </fieldset>

      <!-- ============================== -->
      <!-- 6. Indicadores de Desempenho   -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>6. Indicadores de Desempenho</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="kpiType">Tipo de KPI</label>
            <select id="kpiType" name="kpiType">
              <option value="">Selecione o tipo de KPI</option>
              <option>Produtividade</option>
              <option>Saúde e Segurança</option>
            </select>
          </div>
          <div class="field-group">
            <label for="kpiName">Nome do KPI</label>
            <input id="kpiName" name="kpiName" type="text" maxlength="160" placeholder="Digite o nome do KPI">
          </div>
          <div class="field-group">
            <label for="kpiCurrent">KPI Atual</label>
            <input id="kpiCurrent" name="kpiCurrent" type="text" maxlength="160" placeholder="Digite o KPI atual">
          </div>
          <div class="field-group">
            <label for="kpiExpected">KPI Esperado</label>
            <input id="kpiExpected" name="kpiExpected" type="text" maxlength="160" placeholder="Digite o KPI esperado">
          </div>
        </div>
        <div class="field-group">
          <label for="kpiDescription">Descrição do KPI</label>
          <textarea id="kpiDescription" name="kpiDescription" rows="3"></textarea>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 7. Key Projects (a partir 1MM) -->
      <!-- ============================== -->
      <fieldset id="keyProjectSection" class="form-section hidden">
        <legend>7. KEY Projects</legend>
        <p class="hint">Disponível quando o orçamento é igual ou superior a R$ 1.000.000,00.</p>
        <div id="milestoneList" class="dynamic-list"></div>
        <button type="button" id="addMilestoneBtn" class="btn ghost">Adicionar Marco</button>
        <div id="ganttContainer" class="gantt-container hidden" aria-live="polite">
          <h3 id="ganttChartTitle">Cronograma do Projeto</h3>
          <div id="ganttChart" class="gantt-chart" role="img" aria-label="Gráfico de Gantt do projeto"></div>
        </div>
      </fieldset>

      <div class="form-actions">
        <button type="button" id="saveProjectBtn" class="btn primary">Salvar</button>
        <button type="button" id="sendApprovalBtn" class="btn accent">Enviar para Aprovação</button>
      </div>
    </form>
  </div>

  <div
    id="summaryOverlay"
    class="overlay overlay-summary hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="summaryTitle"
    tabindex="-1"
  >
    <div class="summary-panel">
      <header class="summary-header">
        <h2 id="summaryTitle">Resumo do Projeto</h2>
        <p class="summary-subtitle">Revise as informações antes de confirmar o envio.</p>
      </header>

      <div class="summary-body">
        <div id="summarySections" class="summary-sections"></div>
        <div id="summaryGanttSection" class="summary-gantt hidden">
          <h3>Cronograma do Projeto</h3>
          <div id="summaryGanttChart" class="gantt-chart"></div>
        </div>
      </div>

      <footer class="summary-actions">
        <button type="button" id="summaryEditBtn" class="btn ghost">Voltar e Editar</button>
        <button type="button" id="summaryConfirmBtn" class="btn primary">Confirmar Envio</button>
      </footer>
    </div>
  </div>

  <!-- =============================================================== -->
  <!-- Templates para listas dinâmicas (PEPs, marcos e atividades)    -->
  <!-- =============================================================== -->
  <template id="simplePepTemplate">
    <div class="pep-row" data-pep-id="">
      <div class="field-grid three-cols">
        <div class="field-group">
          <label>Elemento PEP</label>
          <select class="pep-title" required>
            <option value="">Selecione o elemento PEP</option>
            <option>Opção 1</option>
            <option>Opção 2</option>
            <option>Opção 3</option>
          </select>
        </div>
        <div class="field-group">
          <label>Valor do PEP (R$)</label>
          <input type="number" class="pep-amount" min="0" step="0.01" required>
        </div>
        <div class="field-group">
          <label>Ano do PEP</label>
          <input type="number" class="pep-year" min="1900" max="9999" required>
        </div>
      </div>
      <button type="button" class="btn danger remove-row" aria-label="Remover PEP">
        <span class="material-symbols-outlined" aria-hidden="true">delete</span>
      </button>
    </div>
  </template>

  <template id="milestoneTemplate">
    <div class="milestone" data-milestone-id="">
      <div class="milestone-header">
        <div class="field-group full-width">
          <label>Nome do Marco</label>
          <input type="text" class="milestone-title" maxlength="160" required>
        </div>
        <button type="button" class="icon-btn remove-milestone" aria-label="Remover marco">
          <span class="material-symbols-outlined" aria-hidden="true">delete</span>
        </button>
      </div>
      <div class="activity-list"></div>
      <button type="button" class="btn ghost add-activity">Adicionar Atividade</button>
    </div>
  </template>

  <template id="activityTemplate">
    <div class="activity" data-activity-id="" data-pep-id="">
      <div class="activity-header">
        <h4>Atividade</h4>
      </div>
      <div class="field-grid activity-primary-grid">
        <div class="field-group">
          <label>Título da Atividade</label>
          <input type="text" class="activity-title" maxlength="160" required>
        </div>
        <div class="field-group">
          <label>Valor da Atividade (R$)</label>
          <input type="number" class="activity-pep-amount" min="0" step="0.01" required>
        </div>
        <div class="field-group">
          <label>Início da Atividade</label>
          <input type="date" class="activity-start" required>
        </div>
        <div class="field-group">
          <label>Término da Atividade</label>
          <input type="date" class="activity-end" required>
        </div>
      </div>
      <div class="field-group full-width">
        <label>Elemento PEP</label>
        <select class="activity-pep-title" required>
          <option value="">Selecione o elemento PEP</option>
          <option>Opção 1</option>
          <option>Opção 2</option>
          <option>Opção 3</option>
        </select>
      </div>
      <input type="hidden" class="activity-pep-year">
      <div class="field-group full-width">
        <label>Fornecedor</label>
        <input type="text" class="activity-supplier" maxlength="160">
      </div>
      <div class="field-group full-width">
        <label>Descrição Geral da Atividade</label>
        <textarea class="activity-description" rows="5"></textarea>
      </div>
      <button type="button" class="icon-btn remove-activity" aria-label="Remover atividade">
        <span class="material-symbols-outlined" aria-hidden="true">delete</span>
      </button>
    </div>
  </template>

  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="script.js" type="module"></script>
</body>
</html>
