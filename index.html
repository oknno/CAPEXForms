<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CAPEX Projects</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- =============================================================== -->
  <!-- Cabeçalho principal com logo e acesso rápido para novo projeto -->
  <!-- =============================================================== -->
  <header class="main-header">
    <div class="logo" aria-label="Logo CAPEX"></div>
    <button id="newProjectBtn" type="button" class="btn primary">Novo Projeto</button>
  </header>

  <!-- =============================================================== -->
  <!-- Aplicação: sidebar com lista e painel de detalhes do projeto -->
  <!-- =============================================================== -->
  <div id="app" class="app-layout">
    <aside id="projectSidebar" class="sidebar">
      <div class="sidebar-header">
        <h2>Projetos</h2>
        <input id="projectSearch" type="search" placeholder="Pesquisar por nome" autocomplete="off">
      </div>
      <div id="projectList" class="project-list" role="list"></div>
    </aside>

    <section id="projectDetails" class="details" aria-live="polite">
      <div class="empty-state">
        <h2>Selecione um projeto</h2>
        <p>Escolha um item na lista ao lado para visualizar as informações ou iniciar uma edição.</p>
      </div>
    </section>
  </div>

  <!-- =============================================================== -->
  <!-- Formulário de criação/edição de projetos CAPEX -->
  <!-- =============================================================== -->
  <div id="formOverlay" class="overlay hidden" role="dialog" aria-modal="true" aria-labelledby="formTitle">
    <form id="projectForm" class="project-form" novalidate>
      <div class="form-header">
        <h2 id="formTitle">Novo Projeto</h2>
        <div class="form-header-actions">
          <button type="button" id="closeFormBtn" class="btn ghost">Fechar</button>
        </div>
      </div>

      <input type="hidden" id="statusField" value="Rascunho">

      <div id="formStatus" class="feedback" aria-live="polite"></div>
      <div id="formErrors" class="feedback error" aria-live="assertive"></div>

      <!-- ============================== -->
      <!-- 1. Informações SAP             -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>1. Informações SAP</legend>
        <div class="field-group">
          <label for="projectName">Nome do Projeto</label>
          <input id="projectName" name="projectName" type="text" required maxlength="255" placeholder="Título do projeto">
        </div>
        <div class="field-grid">
          <div class="field-group">
            <label for="category">Categoria</label>
            <input id="category" name="category" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="investmentType">Tipo de Investimento</label>
            <input id="investmentType" name="investmentType" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="assetType">Tipo de Ativo</label>
            <input id="assetType" name="assetType" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="projectFunction">Função do Projeto</label>
            <input id="projectFunction" name="projectFunction" type="text" required maxlength="160">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 2. Planejamento Temporal       -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>2. Planejamento Temporal</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="approvalYear">Ano de Aprovação</label>
            <input id="approvalYear" name="approvalYear" type="number" min="1900" max="9999" required>
          </div>
          <div class="field-group">
            <label for="startDate">Data de Início</label>
            <input id="startDate" name="startDate" type="date" required>
          </div>
          <div class="field-group">
            <label for="endDate">Data de Término</label>
            <input id="endDate" name="endDate" type="date" required>
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 3. Orçamento e Recursos        -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>3. Orçamento e Recursos</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="projectBudget">Orçamento do Projeto em R$</label>
            <input id="projectBudget" name="projectBudget" type="number" min="0" step="0.01" required>
            <small id="budgetHint" class="hint"></small>
          </div>
          <div class="field-group">
            <label for="investmentLevel">Nível de Investimento</label>
            <input id="investmentLevel" name="investmentLevel" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="fundingSource">Origem da Verba</label>
            <input id="fundingSource" name="fundingSource" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="depreciationCostCenter">C Custo Depreciação</label>
            <input id="depreciationCostCenter" name="depreciationCostCenter" type="text" required maxlength="80">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 4. Localização Operacional     -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>4. Localização Operacional</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="company">Empresa</label>
            <input id="company" name="company" type="text" required maxlength="120">
          </div>
          <div class="field-group">
            <label for="center">Centro</label>
            <input id="center" name="center" type="text" required maxlength="80">
          </div>
          <div class="field-group">
            <label for="unit">Unidade</label>
            <input id="unit" name="unit" type="text" required maxlength="80">
          </div>
          <div class="field-group">
            <label for="location">Local de Implantação</label>
            <input id="location" name="location" type="text" required maxlength="160">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 5. Responsáveis                -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>5. Responsáveis</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="projectUser">Project User</label>
            <input id="projectUser" name="projectUser" type="text" required maxlength="160">
          </div>
          <div class="field-group">
            <label for="projectLeader">Coordenador do Projeto</label>
            <input id="projectLeader" name="projectLeader" type="text" required maxlength="160">
          </div>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 6. Detalhamento Complementar   -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>6. Detalhamento Complementar</legend>
        <div class="field-group">
          <label for="businessNeed">Sumário do Projeto</label>
          <textarea id="businessNeed" name="businessNeed" rows="4" required></textarea>
        </div>
        <div class="field-group">
          <label for="proposedSolution">Comentário</label>
          <textarea id="proposedSolution" name="proposedSolution" rows="4"></textarea>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 7. Elemento PEP (até 1MM)      -->
      <!-- ============================== -->
      <fieldset id="simplePepSection" class="form-section hidden">
        <legend>7. Elemento PEP</legend>
        <p class="hint">Disponível apenas quando o orçamento é inferior a R$ 1.000.000,00.</p>
        <div id="simplePepList" class="dynamic-list"></div>
        <button type="button" id="addSimplePepBtn" class="btn ghost">Adicionar PEP</button>
      </fieldset>

      <!-- ============================== -->
      <!-- 8. Indicadores de Desempenho   -->
      <!-- ============================== -->
      <fieldset class="form-section">
        <legend>8. Indicadores de Desempenho</legend>
        <div class="field-grid">
          <div class="field-group">
            <label for="kpiType">Tipo de KPI</label>
            <input id="kpiType" name="kpiType" type="text" maxlength="120">
          </div>
          <div class="field-group">
            <label for="kpiName">Nome do KPI</label>
            <input id="kpiName" name="kpiName" type="text" maxlength="160">
          </div>
          <div class="field-group">
            <label for="kpiCurrent">KPI Atual</label>
            <input id="kpiCurrent" name="kpiCurrent" type="number" step="0.01">
          </div>
          <div class="field-group">
            <label for="kpiExpected">KPI Esperado</label>
            <input id="kpiExpected" name="kpiExpected" type="number" step="0.01">
          </div>
        </div>
        <div class="field-group">
          <label for="kpiDescription">Descrição do KPI</label>
          <textarea id="kpiDescription" name="kpiDescription" rows="3"></textarea>
        </div>
      </fieldset>

      <!-- ============================== -->
      <!-- 9. Key Projects (a partir 1MM) -->
      <!-- ============================== -->
      <fieldset id="keyProjectSection" class="form-section hidden">
        <legend>9. KEY Projects</legend>
        <p class="hint">Disponível quando o orçamento é igual ou superior a R$ 1.000.000,00.</p>
        <div id="milestoneList" class="dynamic-list"></div>
        <button type="button" id="addMilestoneBtn" class="btn ghost">Adicionar Marco</button>
      </fieldset>

      <div class="form-actions">
        <button type="submit" id="saveProjectBtn" class="btn primary">Salvar</button>
        <button type="button" id="sendApprovalBtn" class="btn accent">Enviar para Aprovação</button>
      </div>
    </form>
  </div>

  <!-- =============================================================== -->
  <!-- Templates para listas dinâmicas (PEPs, marcos e atividades)    -->
  <!-- =============================================================== -->
  <template id="simplePepTemplate">
    <div class="pep-row" data-pep-id="">
      <div class="field-group">
        <label>Elemento PEP</label>
        <input type="text" class="pep-title" maxlength="120" required>
      </div>
      <div class="field-group">
        <label>Valor do PEP (R$)</label>
        <input type="number" class="pep-amount" min="0" step="0.01" required>
      </div>
      <div class="field-group">
        <label>Ano do PEP</label>
        <input type="number" class="pep-year" min="1900" max="9999" required>
      </div>
      <button type="button" class="btn danger remove-row">Remover</button>
    </div>
  </template>

  <template id="milestoneTemplate">
    <div class="milestone" data-milestone-id="">
      <div class="milestone-header">
        <div class="field-group">
          <label>Nome do Marco</label>
          <input type="text" class="milestone-title" maxlength="160" required>
        </div>
        <button type="button" class="btn danger remove-milestone">Remover Marco</button>
      </div>
      <div class="activity-list"></div>
      <button type="button" class="btn ghost add-activity">Adicionar Atividade</button>
    </div>
  </template>

  <template id="activityTemplate">
    <div class="activity" data-activity-id="">
      <div class="activity-header">
        <h4>Atividade</h4>
        <button type="button" class="btn danger remove-activity">Remover Atividade</button>
      </div>
      <div class="field-grid">
        <div class="field-group">
          <label>Título da Atividade</label>
          <input type="text" class="activity-title" maxlength="160" required>
        </div>
        <div class="field-group">
          <label>Início da Atividade</label>
          <input type="date" class="activity-start" required>
        </div>
        <div class="field-group">
          <label>Término da Atividade</label>
          <input type="date" class="activity-end" required>
        </div>
      </div>
      <div class="field-grid">
        <div class="field-group">
          <label>Fornecedor</label>
          <input type="text" class="activity-supplier" maxlength="160">
        </div>
        <div class="field-group">
          <label>Descrição Geral da Atividade</label>
          <textarea class="activity-description" rows="3"></textarea>
        </div>
      </div>
      <div class="activity-pep-list"></div>
      <button type="button" class="btn ghost add-activity-pep">Adicionar PEP da Atividade</button>
    </div>
  </template>

  <template id="activityPepTemplate">
    <div class="activity-pep" data-pep-id="">
      <div class="field-group">
        <label>Elemento PEP</label>
        <input type="text" class="activity-pep-title" maxlength="120" required>
      </div>
      <div class="field-group">
        <label>Valor CAPEX da atividade (R$)</label>
        <input type="number" class="activity-pep-amount" min="0" step="0.01" required>
      </div>
      <div class="field-group">
        <label>Ano</label>
        <input type="number" class="activity-pep-year" min="1900" max="9999" required>
      </div>
      <button type="button" class="btn danger remove-activity-pep">Remover</button>
    </div>
  </template>

  <script src="script.js" type="module"></script>
</body>
</html>
